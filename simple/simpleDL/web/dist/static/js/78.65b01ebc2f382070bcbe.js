webpackJsonp([78],{ILRq:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("IHPB"),i=a.n(s),n=a("aA9S"),l=a.n(n),c={name:"caseCenter",data:function(){return{states:"",role:2,linTabData:"",linUrl:"",caseIdList:[],pageSize:10,case_status:[],case_type:[],pickerOptions:{shortcuts:[{text:this.$t("views.systemManagement.recentOneWeek"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:this.$t("views.systemManagement.recentOneMonth"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:this.$t("views.systemManagement.recentThreeMonth"),onClick:function(t){var e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},tableData:{msg:[],url:"/casecenter/index",loading:!0,Pagination:{page:1,total_count:5},sel:{name:"",sort:"-created_at",full_date:[],case_status:"",category:""}}}},beforeRouteLeave:function(t,e,a){"createCase"===t.name&&(t.query.hasOwnProperty("caseId")?t.meta.title="views.nav.updateCase":t.meta.title="views.nav.createCase"),a()},methods:{getActiveTab:function(t){this.linTabData=t,this.linUrl=this[t].url,this.initMsg()},sortTable:function(t){"descending"===t.order?this.tableData.sel.sort="-"+t.prop:this.tableData.sel.sort=t.prop,this.initMsg()},clearSearch:function(t){for(var e in this[t].sel)this[t].sel[e]="";void 0!==this[t].Pagination&&(this[t].Pagination.page=1),this.getActiveTab(t)},doSearch:function(t){void 0!==this[t].Pagination&&(this[t].Pagination.page=1),this.getActiveTab(t)},changePage:function(t){this.getActiveTab(t)},initMsg:function(){var t=this;this[this.linTabData].loading=!0;var e={};void 0!==this[this.linTabData].Pagination&&(e=l()({},this[this.linTabData].Pagination,{count:this.pageSize})),void 0!==this[this.linTabData].sel&&(this[this.linTabData].sel.full_date&&2===this[this.linTabData].sel.full_date.length?(this[this.linTabData].sel.start_time=this[this.linTabData].sel.full_date[0],this[this.linTabData].sel.end_time=this[this.linTabData].sel.full_date[1]):(this[this.linTabData].sel.start_time="",this[this.linTabData].sel.end_time=""),e=l()({},e,this[this.linTabData].sel)),e.type=this[this.linTabData].sel.case_status,this.$axios.get(this[this.linTabData].url,{params:e}).then(function(e){var a=e.data.data.image_list;t[t.linTabData].msg=[].concat(i()(a)),void 0!==t[t.linTabData].Pagination&&(t[t.linTabData].Pagination.total_count=e.data.data.total_count),t.pageSize=e.data.data.per_page||10,t[t.linTabData].loading=!1})},selectChange:function(t){this.caseIdList=[];for(var e=0;e<t.length;e++)this.caseIdList.push(t[e].id)},selectable:function(t){return 1!==Number(t.is_built)},changeCase:function(t){isNaN(t)?this.$router.push({name:"createCase"}):this.$router.push({name:"createCase",query:{caseId:t}})},deleteCase:function(t){var e=this,a=[],s=!0;void 0===t?(this.caseIdList.length>0?a=[].concat(i()(this.caseIdList)):(s=!1,this.$message({type:"warning",message:this.$t("views.dialogText.selectNull")})),s&&this.mixinConfirm("/casecenter/delete",{case_center_id:a}).then(function(t){t&&e.doSearch("tableData")})):(a=[t],this.mixinConfirm("/casecenter/deletealone",{case_center_id:a}).then(function(t){t&&e.doSearch("tableData")}))}},created:function(){var t=this;this.getActiveTab("tableData"),this.role=JSON.parse(sessionStorage.getItem("userinfo")).role,this.$get("/casecenter/casecentercategorylist").then(function(e){t.case_type=[].concat(i()(e.data))})}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"tab-select"},[a("div",[a("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.caseCenterPage.caseName")))]),t._v(" "),a("el-input",{staticClass:"views-input-text",attrs:{placeholder:t.$t("views.caseCenterPage.caseName")},model:{value:t.tableData.sel.name,callback:function(e){t.$set(t.tableData.sel,"name",e)},expression:"tableData.sel.name"}})],1),t._v(" "),a("div",[a("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.table.createTime")))]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange",editable:!1,align:"right","range-separator":"-","value-format":"yyyy-MM-dd","picker-options":t.pickerOptions,"start-placeholder":t.$t("views.button.startDate"),"end-placeholder":t.$t("views.button.endDate")},model:{value:t.tableData.sel.full_date,callback:function(e){t.$set(t.tableData.sel,"full_date",e)},expression:"tableData.sel.full_date"}})],1),t._v(" "),a("div",[a("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.caseCenterPage.caseType")))]),t._v(" "),a("el-select",{attrs:{placeholder:t.$t("views.button.selectPlease")},model:{value:t.tableData.sel.category,callback:function(e){t.$set(t.tableData.sel,"category",e)},expression:"tableData.sel.category"}},t._l(t.case_type,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("div",[a("el-button",{staticClass:"btn light small",on:{click:function(e){return t.clearSearch("tableData")}}},[t._v(t._s(t.$t("views.button.reset")))]),t._v(" "),a("el-button",{staticClass:"btn light small",on:{click:function(e){return t.doSearch("tableData")}}},[t._v(t._s(t.$t("views.button.search")))])],1)]),t._v(" "),2===t.role?a("div",{staticClass:"controls-else"},[a("el-button",{staticClass:"btn dark mid",on:{click:function(e){return t.changeCase()}}},[t._v(t._s(t.$t("views.caseCenterPage.createBtnL")))]),t._v(" "),a("el-button",{staticClass:"btn dark mid",on:{click:function(e){return t.deleteCase()}}},[t._v(t._s(t.$t("views.button.batchDelete")))])],1):t._e(),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableData.loading,expression:"tableData.loading"}],staticClass:"tab-content",attrs:{data:t.tableData.msg,border:""},on:{"sort-change":t.sortTable,"selection-change":t.selectChange}},[2===t.role?a("el-table-column",{attrs:{type:"selection",selectable:t.selectable,width:"55",align:"center"}}):a("el-table-column",{attrs:{type:"index",width:"55",label:t.$t("views.table.number"),align:"center"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("views.caseCenterPage.caseName"),sortable:"custom",prop:"name","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("router-link",{staticClass:"link",attrs:{to:{name:"caseDetail",query:{caseId:e.row.id}}}},[t._v(t._s(e.row.name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"created_at",sortable:"custom",align:"center",width:"180",label:t.$t("views.table.createTime")}}),t._v(" "),a("el-table-column",{attrs:{prop:"category",width:"180",sortable:"custom",align:"center","show-overflow-tooltip":"",label:t.$t("views.caseCenterPage.caseType")},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.caseCategory.name)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"describe","show-overflow-tooltip":"",label:t.$t("views.caseCenterPage.caseDesc")}}),t._v(" "),2===t.role?a("el-table-column",{attrs:{label:t.$t("views.table.operate"),width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return a("div",{staticClass:"options",staticStyle:{"text-align":"center"}},[1==e.row.is_built?a("div",[t._v("--")]):a("div",[a("button",{staticClass:"btn",on:{click:function(a){return t.changeCase(e.row.id)}}},[t._v(t._s(t.$t("views.button.update")))]),t._v(" "),a("button",{staticClass:"del",on:{click:function(a){return t.deleteCase(e.row.id)}}},[t._v(t._s(t.$t("views.button.delete")))])])])}}],null,!1,434640803)}):t._e(),t._v(" "),a("div",{attrs:{slot:"empty"},slot:"empty"},[a("div",{staticClass:"views-empty"},[a("span",{staticClass:"views-empty-table"}),t._v(" "),a("p",{staticClass:"views-empty-text"},[t._v(t._s(t.$t("views.table.noData")))])])])],1),t._v(" "),a("el-pagination",{staticClass:"tab-page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.tableData.Pagination.page,total:t.tableData.Pagination.total_count},on:{"update:currentPage":function(e){return t.$set(t.tableData.Pagination,"page",e)},"update:current-page":function(e){return t.$set(t.tableData.Pagination,"page",e)},"current-change":function(e){return t.changePage("tableData")}}})],1)},staticRenderFns:[]},r=a("C7Lr")(c,o,!1,null,null,null);e.default=r.exports}});