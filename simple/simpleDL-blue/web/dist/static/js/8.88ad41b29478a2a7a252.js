webpackJsonp([8],{iUPt:function(t,e,n){(t.exports=n("UTlt")(!1)).push([t.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},j3MC:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=n("IHPB"),s=n.n(a),i=n("4YfN"),o=n.n(i),r=n("aA9S"),l=n.n(r),c=n("v46e"),g={name:"announcement",data:function(){return{createStorageDialog:!1,states:"",isDisabel:!1,linTabData:"",linUrl:"",createStorage:{storage_name:"",project_id:"",storage_description:""},proList:[],arcProList:[],storageIdList:[],pageSize:3,pickerOptions:{shortcuts:[{text:this.$t("views.systemManagement.recentOneWeek"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-6048e5),t.$emit("pick",[n,e])}},{text:this.$t("views.systemManagement.recentOneMonth"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-2592e6),t.$emit("pick",[n,e])}},{text:this.$t("views.systemManagement.recentThreeMonth"),onClick:function(t){var e=new Date,n=new Date;n.setTime(n.getTime()-7776e6),t.$emit("pick",[n,e])}}]},tableData:{msg:[],url:"/storage/storagelist",loading:!0,Pagination:{page:1,total_count:5},sel:{php_name:"",sort:"",project_id:"",is_init:2,full_date:[]}}}},methods:{changeStorage:function(){this.createStorageDialog=!0},saveStorage:function(){var t=this;if(""===this.createStorage.storage_name)return this.$message({message:this.$t("views.storageManagement.valid.notNullName"),type:"error"}),!1;if(""===this.createStorage.project_id)return this.$message({message:this.$t("views.storageManagement.valid.notNullPro"),type:"error"}),!1;if(!Object(c.b)(this.createStorage.storage_name)||this.createStorage.storage_name.length<3)return this.$message({message:this.$t("views.storageManagement.valid.regStr"),type:"error"}),!1;this.isDisabel=!0;var e={is_init:this.tableData.sel.is_init,php_name:this.createStorage.storage_name,project_id:this.createStorage.project_id,describe:this.createStorage.storage_description};this.$post("/storage/storagecreate",{Storage:e}).then(function(e){200===e.code?(t.$message({message:t.$t("views.notification.saved"),type:"success"}),t.createStorageDialog=!1,t.getActiveTab("tableData")):t.isDisabel=!1})},clearCreatInfo:function(){this.isDisabel=!1,this.createStorage.storage_description="",this.createStorage.project_id="",this.createStorage.storage_name=""},sortTable:function(t){"descending"===t.order?this.tableData.sel.sort="-"+t.prop:this.tableData.sel.sort=t.prop,this.initMsg()},saveAuthenticate:function(t){var e=document.createElement("a");e.href=window.Simple.php+"/v1/storage/downloadkey?access-token="+JSON.parse(sessionStorage.getItem("userinfo")).access_token+"&storage_id="+t.id,document.body.appendChild(e),setTimeout(function(t){e.click(),document.body.removeChild(e)},5)},getActiveTab:function(t){this.createStorage.storage_name="",this.createStorage.storage_description="",this.createStorage.project_id="",this.linTabData=t,this.linUrl=this[t].url,this.initMsg()},clearSearch:function(t){for(var e in this[t].sel)"is_init"!==e&&(this[t].sel[e]="");void 0!==this[t].Pagination&&(this[t].Pagination.page=1),this.getActiveTab(t)},doSearch:function(t){void 0!==this[t].Pagination&&(this[t].Pagination.page=1),this.getActiveTab(t)},changePage:function(t){this.getActiveTab(t)},initMsg:function(){var t=this;this[this.linTabData].loading=!0;var e={};void 0!==this[this.linTabData].Pagination&&(e=l()({},this[this.linTabData].Pagination,{count:this.pageSize})),void 0!==this[this.linTabData].sel&&(this[this.linTabData].sel.full_date&&2===this[this.linTabData].sel.full_date.length?(this[this.linTabData].sel.start_time=this[this.linTabData].sel.full_date[0],this[this.linTabData].sel.end_time=this[this.linTabData].sel.full_date[1]):(this[this.linTabData].sel.start_time="",this[this.linTabData].sel.end_time=""),e=l()({},e,this[this.linTabData].sel)),this.$post(this[this.linTabData].url+"?sort="+e.sort,{StorageSearch:o()({},e),page:e.page}).then(function(e){var n=e.data.storage_list;t[t.linTabData].msg=[].concat(s()(n)),void 0!==t[t.linTabData].Pagination&&(t[t.linTabData].Pagination.total_count=e.data.total_count),t.pageSize=e.data.per_page,t[t.linTabData].loading=!1})},fileManage:function(t){this.$router.push({name:"proStorageDetail",query:{id:t,is_init:this.tableData.sel.is_init}})},deleteStorage:function(t){var e=this;this.mixinConfirm("/storage/storagedelete",{storage_id:[t],force:0}).then(function(t){t&&e.getActiveTab("tableData")})}},created:function(){var t=this;this.$get("/storage/progectlist",{guidangshow:1}).then(function(e){200===e.code&&(t.proList=e.data)}),this.$get("/storage/progectlist",{guidangshow:0}).then(function(e){200===e.code&&(t.arcProList=e.data)}),this.role=JSON.parse(sessionStorage.getItem("userinfo")).role,this.getActiveTab("tableData")}},p={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"announcement"},[n("div",{staticClass:"tab-select"},[n("div",[n("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.storageManagement.storage.storageName")))]),t._v(" "),n("el-input",{staticClass:"views-input-text",attrs:{placeholder:t.$t("views.storageManagement.storage.storageName")},model:{value:t.tableData.sel.php_name,callback:function(e){t.$set(t.tableData.sel,"php_name",e)},expression:"tableData.sel.php_name"}})],1),t._v(" "),n("div",[n("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.table.createTime")))]),t._v(" "),n("el-date-picker",{attrs:{type:"daterange",editable:!1,"range-separator":"-","picker-options":t.pickerOptions,"value-format":"yyyy-MM-dd","start-placeholder":t.$t("views.button.startDate"),"end-placeholder":t.$t("views.button.endDate")},model:{value:t.tableData.sel.full_date,callback:function(e){t.$set(t.tableData.sel,"full_date",e)},expression:"tableData.sel.full_date"}})],1),t._v(" "),n("div",[n("span",{staticClass:"tab-select-title"},[t._v(t._s(t.$t("views.storageManagement.storage.belongSpace")))]),t._v(" "),n("el-select",{attrs:{clearable:"",filterable:"",placeholder:t.$t("views.imageManagement.chose")},model:{value:t.tableData.sel.project_id,callback:function(e){t.$set(t.tableData.sel,"project_id",e)},expression:"tableData.sel.project_id"}},t._l(t.proList,function(t,e){return n("el-option",{key:e,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),n("div",[n("el-button",{staticClass:"btn light small",on:{click:function(e){return t.clearSearch("tableData")}}},[t._v(t._s(t.$t("views.button.reset")))]),t._v(" "),n("el-button",{staticClass:"btn light small",on:{click:function(e){return t.doSearch("tableData")}}},[t._v(t._s(t.$t("views.button.search")))])],1)]),t._v(" "),n("div",{staticClass:"controls-else"},[n("el-button",{staticClass:"view-btn-medium",on:{click:t.changeStorage}},[t._v(t._s(t.$t("views.storageManagement.storage.btnCreatePro")))])],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableData.loading,expression:"tableData.loading"}],staticClass:"tab-content",attrs:{data:t.tableData.msg,border:""},on:{"sort-change":t.sortTable}},[n("el-table-column",{attrs:{type:"index",label:t.$t("views.table.number"),width:"55","header-align":"center",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("views.storageManagement.storage.storageName"),prop:"php_name","show-overflow-tooltip":"",sortable:"custom"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.is_archive?n("router-link",{staticClass:"link",attrs:{to:{name:"proStorageDetail",query:{id:e.row.id,is_init:t.tableData.sel.is_init}}}},[t._v(t._s(e.row.php_name))]):n("span",[t._v(t._s(e.row.php_name))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"created_at",width:"200",sortable:"custom",align:"center",label:t.$t("views.table.createTime")}}),t._v(" "),n("el-table-column",{attrs:{prop:"project_name","show-overflow-tooltip":"",label:t.$t("views.storageManagement.storage.belongSpace")}}),t._v(" "),n("el-table-column",{attrs:{label:"项目状态",align:"center",prop:"is_archive"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.is_archive?n("span",[t._v("开发中")]):n("span",[t._v("已归档")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"describe","show-overflow-tooltip":"",label:t.$t("views.table.describe")}}),t._v(" "),n("el-table-column",{attrs:{label:t.$t("views.table.operate"),width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return n("div",{staticClass:"options text-center"},[n("button",{staticClass:"btn",on:{click:function(n){return t.fileManage(e.row.id)}}},[t._v(t._s(t.$t("views.storageManagement.storage.btnFileManege")))]),t._v(" "),n("button",{staticClass:"btn",on:{click:function(n){return t.saveAuthenticate(e.row)}}},[t._v("\n          "+t._s(t.$t("views.storageManagement.storage.btnSaveAuthenticate"))+"\n        ")]),t._v(" "),n("button",{staticClass:"del",on:{click:function(n){return t.deleteStorage(e.row.id)}}},[t._v(t._s(t.$t("views.button.delete")))])])}}])}),t._v(" "),n("div",{attrs:{slot:"empty"},slot:"empty"},[n("div",{staticClass:"views-empty"},[n("span",{staticClass:"views-empty-table"}),t._v(" "),n("p",{staticClass:"views-empty-text"},[t._v(t._s(t.$t("views.table.noData")))])])])],1),t._v(" "),n("el-pagination",{staticClass:"tab-page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.tableData.Pagination.page,total:t.tableData.Pagination.total_count},on:{"update:currentPage":function(e){return t.$set(t.tableData.Pagination,"page",e)},"update:current-page":function(e){return t.$set(t.tableData.Pagination,"page",e)},"current-change":function(e){return t.changePage("tableData")}}}),t._v(" "),n("el-dialog",{staticClass:"small",attrs:{title:t.$t("views.storageManagement.storage.btnCreatePro"),visible:t.createStorageDialog},on:{"update:visible":function(e){t.createStorageDialog=e},close:t.clearCreatInfo}},[n("div",[n("div",{staticClass:"create-storage"},[n("span",[n("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v(t._s(t.$t("views.storageManagement.storage.spaceName")))]),t._v(" "),n("el-input",{attrs:{maxlength:"30"},model:{value:t.createStorage.storage_name,callback:function(e){t.$set(t.createStorage,"storage_name",e)},expression:"createStorage.storage_name"}})],1),t._v(" "),n("div",{staticClass:"create-storage"},[n("span",[n("i",{staticStyle:{color:"red"}},[t._v("*")]),t._v(t._s(t.$t("views.storageManagement.storage.selectSpace")))]),t._v(" "),n("el-select",{attrs:{placeholder:t.$t("views.imageManagement.chose")},model:{value:t.createStorage.project_id,callback:function(e){t.$set(t.createStorage,"project_id",e)},expression:"createStorage.project_id"}},t._l(t.arcProList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),n("div",{staticClass:"create-storage"},[n("span",[t._v(t._s(t.$t("views.table.describe")))]),t._v(" "),n("el-input",{attrs:{type:"textarea",maxlength:"200",rows:"4"},model:{value:t.createStorage.storage_description,callback:function(e){t.$set(t.createStorage,"storage_description",e)},expression:"createStorage.storage_description"}})],1)]),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{size:"medium"},on:{click:function(e){t.createStorageDialog=!1}}},[t._v(t._s(t.$t("views.button.cancel")))]),t._v(" "),n("el-button",{staticClass:"view-btn-medium",attrs:{disabled:t.isDisabel},on:{click:t.saveStorage}},[t._v(t._s(t.$t("views.button.save")))])],1)])],1)},staticRenderFns:[]};var u=n("C7Lr")(g,p,!1,function(t){n("ptWI")},"data-v-7b475a40",null);e.default=u.exports},ptWI:function(t,e,n){var a=n("iUPt");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("FIqI")("244ed274",a,!0,{})}});