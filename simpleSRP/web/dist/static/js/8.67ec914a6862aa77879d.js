webpackJsonp([8],{"+7zR":function(e,t,n){e.exports=n("5f7L")},"5f7L":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("rVsN"),o=n.n(i),s=n("ZLEe"),r=n.n(s),a=n("aA9S"),u=n.n(a),l=n("AA3o"),c=n.n(l),d=n("xSur"),f=n.n(d),m=function(){function e(){c()(this,e),this.listeners={}}return f()(e,[{key:"on",value:function(e,t){void 0===this.listeners[e]&&(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"emit",value:function(e){this.listeners[e]&&this.listeners[e].forEach(function(e){return e()})}}]),e}(),p={name:"VueUeditorWrap",data:function(){return{id:"editor"+Math.random().toString().slice(-10),editor:null,defaultConfig:{UEDITOR_HOME_URL:"./static/UEditor/",enableAutoSave:!1}}},props:{value:{type:String,default:"Vue2.x + UEditor + v-model双向绑定"},config:{type:Object,default:function(){return{}}},init:{type:Function,default:function(){return function(){}}},destroy:Boolean},computed:{mixedConfig:function(){return u()({},this.defaultConfig,this.config)}},methods:{registerButton:function(e){var t=e.name,n=e.icon,i=e.tip,o=e.handler,s=e.UE,r=void 0===s?window.UE:s;r.registerUI(t,function(e,t){e.registerCommand(t,{execCommand:function(){o(e,t)}});var s=new r.ui.Button({name:t,title:i,cssRules:"background-image: url("+n+") !important;background-size: cover;",onclick:function(){e.execCommand(t)}});return e.addListener("selectionchange",function(){var n=e.queryCommandState(t);-1===n?(s.setDisabled(!0),s.setChecked(!1)):(s.setDisabled(!1),s.setChecked(n))}),s})},_beforeInitEditor:function(e){var t=this;window.UE&&window.UEDITOR_CONFIG&&0!==r()(window.UEDITOR_CONFIG).length&&window.UE.getEditor?this._initEditor(e):this._loadScripts().then(function(){return t._initEditor(e)})},_initEditor:function(e){var t=this;this.$nextTick(function(){t.init(),t.editor=window.UE.getEditor(t.id,t.mixedConfig),t.editor.addListener("ready",function(){t.$emit("ready",t.editor),t.editor.setContent(e),t.editor.addListener("contentChange",function(){t.$emit("input",t.editor.getContent())})})})},_loadScripts:function(){var e=this;return window.loadEnv?new o.a(function(e,t){window.loadEnv.on("scriptsLoaded",function(){e()})}):(window.loadEnv=new m,new o.a(function(t,n){e._loadConfig().then(function(){return e._loadCore()}).then(function(){window.loadEnv.emit("scriptsLoaded"),t()})}))},_loadConfig:function(){var e=this;return new o.a(function(t,n){if(window.UE&&window.UEDITOR_CONFIG&&0!==r()(window.UEDITOR_CONFIG).length)t();else{var i=document.createElement("script");i.type="text/javascript",i.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.config.js",document.getElementsByTagName("head")[0].appendChild(i),i.onload=function(){window.UE&&window.UEDITOR_CONFIG&&0!==r()(window.UEDITOR_CONFIG).length?t():console&&console.error("加载ueditor.config.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!")}}})},_loadCore:function(){var e=this;return new o.a(function(t,n){if(window.UE&&window.UE.getEditor)t();else{var i=document.createElement("script");i.type="text/javascript",i.src=e.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.min.js",document.getElementsByTagName("head")[0].appendChild(i),i.onload=function(){window.UE&&window.UE.getEditor?t():console&&console.error("加载ueditor.all.min.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!")}}})},_setContent:function(e){e===this.editor.getContent()||this.editor.setContent(e)}},beforeDestroy:function(){this.destroy&&this.editor&&this.editor.destroy&&this.editor.destroy()},watch:{value:{handler:function(e){this.editor?this._setContent(e):this._beforeInitEditor(e)},immediate:!0}}},h={render:function(){var e=this.$createElement;return(this._self._c||e)("script",{attrs:{id:this.id,type:"text/plain"}})},staticRenderFns:[]},_=n("C7Lr")(p,h,!1,null,null,null);t.default=_.exports},AA3o:function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},vfs7:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("+7zR"),o={name:"forumDetails",data:function(){return{forumMsg:{forum_id:"",content:"啊实打实打算"},forum:{},obj:{forum_id:""},loading:!1,isReply:!1,load:!0,reply_list:[],uetest:"请输入内容asdasdasdasd",config:{serverUrl:window.Simple.php+"/controller.php",UEDITOR_HOME_URL:"/static/UEditor/",autoHeightEnabled:!1,initialFrameHeight:400,initialFrameWidth:"100%",enableAutoSave:!0,initialContent:"",autoClearinitialContent:!1},userCharacter:"",replyPop:!1}},components:{VueUeditorWrap:n.n(i).a},methods:{getForumdetail:function(e){var t=this;this.$get("/forum/forumdetail",e).then(function(e){200===e.code?(t.forum=e.data.forum,t.reply_list=e.data.forum_article,0===t.reply_list.length?t.isReply=!1:t.isReply=!0):t.$message({message:e.message,type:"error"})})},ready:function(e){console.log("你要的实例"+e.key+"在此:",e),this.ue=e},myInit:function(){this.$refs.ueditor.registerButton({name:"test",icon:"./static/test-button.png",tip:"this is a test tip",handler:function(e,t){e.execCommand("inserthtml","<span>text inserted by test button</span>")}})},deleteItem:function(e){var t=this;this.$confirm("确定删除该帖子回复?","删除帖子回复",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var n={forum_article_id:e};t.$post("/forum/deletforumarticle",n).then(function(e){200===e.code?(t.$message({message:e.message,type:"success"}),t.getForumdetail(t.obj)):t.$message({message:e.message,type:"error"})})}).catch(function(){})},showReplyPop:function(){this.replyPop=!0,this.forumMsg.content=""},changeReplyPop:function(){var e=this;if(this.loading=!0,this.forumMsg.content=this.ue.getContent(),""===this.forumMsg.content)return this.$message({message:"回复内容不能为空",type:"warning"}),!1;this.$post("/forum/forumreply",this.forumMsg).then(function(t){200===t.code?(e.$message({message:t.message,type:"success"}),e.getForumdetail(e.obj),e.replyPop=!1):(e.$message({message:t.message,type:"error"}),e.loading=!1)})},closeReply:function(){this.loading=!1}},created:function(){this.obj.forum_id=this.forumMsg.forum_id=this.$route.query.forumId,this.getForumdetail(this.obj)}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"views-research-forum-details"},[n("p",{staticClass:"forum-title"},[e._v("\n    "+e._s(e.forum.title)+"\n    "),n("el-button",{staticClass:"btn dark small",on:{click:e.showReplyPop}},[e._v(e._s(e.$t("views.researchForum.reply")))])],1),e._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"title"},[n("div",[n("span",[e._v(e._s(e.$t("views.researchForum.author"))+"："+e._s(e.forum.user_name))]),e._v("\n        |\n        "),n("span",[e._v(e._s(e.$t("views.researchForum.issuingTime"))+"："+e._s(e.forum.created_at))])]),e._v(" "),n("div",[n("span",[e._v(e._s(e.$t("views.researchForum.click"))+"："+e._s(e.forum.views))]),e._v("\n        |\n        "),n("span",[e._v(e._s(e.$t("views.researchForum.reply"))+"："+e._s(e.forum.reply_num))])])]),e._v(" "),n("div",{staticClass:"msg",domProps:{innerHTML:e._s(e.forum.content)}})]),e._v(" "),e.isReply?n("ul",{staticClass:"reply"},e._l(e.reply_list,function(t,i){return n("li",{key:i},[n("p",{staticClass:"name"},[e._v(e._s(e.$t("views.researchForum.replies"))+"："+e._s(t.replyer))]),e._v(" "),n("p",{staticClass:"views-forum-reply",domProps:{innerHTML:e._s(t.content)}}),e._v(" "),n("p",{staticClass:"time"},[e._v("\n        "+e._s(e.$t("views.researchForum.postingTime"))+"："+e._s(t.created_at)+"\n        "),"delete"===t.delete?n("button",{on:{click:function(n){return e.deleteItem(t.id)}}},[n("i",{staticClass:"icon iconfont icon-shanchu2"}),e._v(e._s(e.$t("views.researchForum.delete")))]):e._e()])])}),0):n("div",{staticClass:"views-empty reply"},[n("span",{staticClass:"views-empty-table"}),e._v(" "),n("p",{staticClass:"views-empty-text"},[e._v("暂无回复")])]),e._v(" "),n("el-dialog",{staticClass:"replyPop big",attrs:{title:e.$t("views.researchForum.postReply"),visible:e.replyPop},on:{"update:visible":function(t){e.replyPop=t},close:e.closeReply}},[n("div",{staticClass:"content"},[n("vue-ueditor-wrap",{ref:"ueditor",attrs:{destroy:!1,config:e.config,init:e.myInit,defaultMsg:e.uetest},on:{ready:e.ready},model:{value:e.forumMsg.content,callback:function(t){e.$set(e.forumMsg,"content",t)},expression:"forumMsg.content"}})],1),e._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{staticClass:"cancel",on:{click:function(t){e.replyPop=!1}}},[e._v(e._s(e.$t("views.researchForum.cancel")))]),e._v(" "),n("el-button",{staticClass:"primary",attrs:{type:"primary",disabled:e.loading},on:{click:e.changeReplyPop}},[e._v(e._s(e.$t("views.researchForum.release")))])],1)])],1)},staticRenderFns:[]},r=n("C7Lr")(o,s,!1,null,null,null);t.default=r.exports},xSur:function(e,t,n){"use strict";t.__esModule=!0;var i,o=n("liLe"),s=(i=o)&&i.__esModule?i:{default:i};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,s.default)(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}()}});