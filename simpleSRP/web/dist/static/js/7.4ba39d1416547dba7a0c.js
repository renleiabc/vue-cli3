webpackJsonp([7],{"+7zR":function(t,e,n){t.exports=n("5f7L")},"5f7L":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("rVsN"),o=n.n(i),r=n("ZLEe"),s=n.n(r),a=n("aA9S"),d=n.n(a),u=n("AA3o"),c=n.n(u),l=n("xSur"),f=n.n(l),h=function(){function t(){c()(this,t),this.listeners={}}return f()(t,[{key:"on",value:function(t,e){void 0===this.listeners[t]&&(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"emit",value:function(t){this.listeners[t]&&this.listeners[t].forEach(function(t){return t()})}}]),t}(),g={name:"VueUeditorWrap",data:function(){return{id:"editor"+Math.random().toString().slice(-10),editor:null,defaultConfig:{UEDITOR_HOME_URL:"./static/UEditor/",enableAutoSave:!1}}},props:{value:{type:String,default:"Vue2.x + UEditor + v-model双向绑定"},config:{type:Object,default:function(){return{}}},init:{type:Function,default:function(){return function(){}}},destroy:Boolean},computed:{mixedConfig:function(){return d()({},this.defaultConfig,this.config)}},methods:{registerButton:function(t){var e=t.name,n=t.icon,i=t.tip,o=t.handler,r=t.UE,s=void 0===r?window.UE:r;s.registerUI(e,function(t,e){t.registerCommand(e,{execCommand:function(){o(t,e)}});var r=new s.ui.Button({name:e,title:i,cssRules:"background-image: url("+n+") !important;background-size: cover;",onclick:function(){t.execCommand(e)}});return t.addListener("selectionchange",function(){var n=t.queryCommandState(e);-1===n?(r.setDisabled(!0),r.setChecked(!1)):(r.setDisabled(!1),r.setChecked(n))}),r})},_beforeInitEditor:function(t){var e=this;window.UE&&window.UEDITOR_CONFIG&&0!==s()(window.UEDITOR_CONFIG).length&&window.UE.getEditor?this._initEditor(t):this._loadScripts().then(function(){return e._initEditor(t)})},_initEditor:function(t){var e=this;this.$nextTick(function(){e.init(),e.editor=window.UE.getEditor(e.id,e.mixedConfig),e.editor.addListener("ready",function(){e.$emit("ready",e.editor),e.editor.setContent(t),e.editor.addListener("contentChange",function(){e.$emit("input",e.editor.getContent())})})})},_loadScripts:function(){var t=this;return window.loadEnv?new o.a(function(t,e){window.loadEnv.on("scriptsLoaded",function(){t()})}):(window.loadEnv=new h,new o.a(function(e,n){t._loadConfig().then(function(){return t._loadCore()}).then(function(){window.loadEnv.emit("scriptsLoaded"),e()})}))},_loadConfig:function(){var t=this;return new o.a(function(e,n){if(window.UE&&window.UEDITOR_CONFIG&&0!==s()(window.UEDITOR_CONFIG).length)e();else{var i=document.createElement("script");i.type="text/javascript",i.src=t.mixedConfig.UEDITOR_HOME_URL+"ueditor.config.js",document.getElementsByTagName("head")[0].appendChild(i),i.onload=function(){window.UE&&window.UEDITOR_CONFIG&&0!==s()(window.UEDITOR_CONFIG).length?e():console&&console.error("加载ueditor.config.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!")}}})},_loadCore:function(){var t=this;return new o.a(function(e,n){if(window.UE&&window.UE.getEditor)e();else{var i=document.createElement("script");i.type="text/javascript",i.src=t.mixedConfig.UEDITOR_HOME_URL+"ueditor.all.min.js",document.getElementsByTagName("head")[0].appendChild(i),i.onload=function(){window.UE&&window.UE.getEditor?e():console&&console.error("加载ueditor.all.min.js失败,请检查您的配置地址UEDITOR_HOME_URL填写是否正确!")}}})},_setContent:function(t){t===this.editor.getContent()||this.editor.setContent(t)}},beforeDestroy:function(){this.destroy&&this.editor&&this.editor.destroy&&this.editor.destroy()},watch:{value:{handler:function(t){this.editor?this._setContent(t):this._beforeInitEditor(t)},immediate:!0}}},m={render:function(){var t=this.$createElement;return(this._self._c||t)("script",{attrs:{id:this.id,type:"text/plain"}})},staticRenderFns:[]},p=n("C7Lr")(g,m,!1,null,null,null);e.default=p.exports},AA3o:function(t,e,n){"use strict";e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},"Oke+":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n("+7zR"),o={name:"forumSend",data:function(){return{title:"",content:"",loading:!1,type:1,config:{serverUrl:window.Simple.php+"/controller.php",UEDITOR_HOME_URL:"/static/UEditor/",autoHeightEnabled:!1,initialFrameHeight:400,initialFrameWidth:"100%",lang:"en",enableAutoSave:!0},ue:null,userCharacter:""}},components:{VueUeditorWrap:n.n(i).a},methods:{ready:function(t){console.log("你要的实例"+t.key+"在此:",t),this.ue=t},myInit:function(){this.$refs.ueditor.registerButton({name:"test",icon:"./static/test-button.png",tip:"this is a test tip",handler:function(t,e){t.execCommand("inserthtml","<span>text inserted by test button</span>")}})},clearMsg:function(){this.title="",this.content=""},sendMsg:function(){var t=this,e=/^\s*$/g;if(this.content=this.ue.getContent(),console.log(this.content),""===this.title||e.test(this.title)||null==this.title)return this.$message({message:"主题不能为空",type:"warning"}),!1;if(""===this.content||e.test(this.content))return this.$message({message:"内容不能为空或者只有特殊字符",type:"warning"}),!1;this.loading=!0;var n={};n.title=this.title,n.content=this.content,n.type=this.forumaddper.type,this.$post("/forum/saveforum",n).then(function(e){200===e.code?(t.$message({message:e.message,type:"success"}),t.clearMsg(),t.loading=!1,t.$router.go(-1)):t.$message({message:e.message,type:"error"})})},radioChange:function(t){console.log(t)}},created:function(){this.config.lang="zh"===this.$store.getters.language?this.$store.getters.language+"-cn":this.$store.getters.language,this.userCharacter=this.$store.getters.checkUserCharacter,this.$store.dispatch("getforumaddper"),this.type=this.forumaddper},computed:{forumaddper:function(){return this.$store.getters.postForumaddper}}},r={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"views-research-forum-send"},[n("div",{staticClass:"title"},[n("div",[t._v("\n      "+t._s(t.$t("views.researchForum.theme"))+"\n      "),n("el-input",{attrs:{placeholder:t.$t("views.researchForum.enter"),maxlength:"80",clearable:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),n("div",[t._v("\n      "+t._s(t.$t("views.researchForum.postType"))+"\n      "),n("el-radio-group",{on:{change:t.radioChange},model:{value:t.forumaddper.type,callback:function(e){t.$set(t.forumaddper,"type",e)},expression:"forumaddper.type"}},t._l(t.forumaddper.data,function(e,i){return n("el-radio",{key:i,attrs:{label:e.value}},[t._v("\n          "+t._s(e.label)+"\n        ")])}),1)],1)]),t._v(" "),n("vue-ueditor-wrap",{ref:"ueditor",attrs:{destroy:!1,config:t.config,init:t.myInit},on:{ready:t.ready},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),n("div",{staticClass:"controls"},[n("el-button",{staticClass:"btn dark",on:{click:t.clearMsg}},[t._v(t._s(t.$t("views.researchForum.empty")))]),t._v(" "),n("el-button",{staticClass:"btn dark",attrs:{loading:t.loading},on:{click:t.sendMsg}},[t._v(t._s(t.$t("views.researchForum.publish")))])],1)],1)},staticRenderFns:[]},s=n("C7Lr")(o,r,!1,null,null,null);e.default=s.exports},xSur:function(t,e,n){"use strict";e.__esModule=!0;var i,o=n("liLe"),r=(i=o)&&i.__esModule?i:{default:i};e.default=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}()}});